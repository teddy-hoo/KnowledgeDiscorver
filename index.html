
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../../assets/ico/favicon.ico">
    <link href="libs/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <script src="libs/jquery/jquery-1.11.1.min.js"></script>
    <script src="libs/d3/d3.min.js"></script>
    <script src="draw/draw.js"></script>

    <title>Knowledge Discover</title>
    <style>
      .axis path,
      .axis line {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
      }

      .x.axis path {
        display: none;
      }

      .line {
        fill: none;
        stroke: steelblue;
        stroke-width: 1.5px;
      }
    </style>
    <script>
      var wordtagcss = [
        'label label-primary',
        'label label-success',
        'label label-info',
        'label label-warning',
        'label label-danger'
        ];
      var plot = null;
      $(document).ready(function(){
        var action = function(){
          var word = $("#wordinput").val();
          if(word == ""){
            return;
          }
          var words = word.split(',');
          var data = {
            "words": words
          };
          $.post("", JSON.stringify(data), function(ngramdata){
            var wordsdata = JSON.parse(ngramdata);
            var dataforrender = [];
            var wordcount = wordsdata.length;
            var timelength = wordsdata[0].timeseries.length;
            for(var i = 0; i < timelength; ++i){
              var subdata = {};
              for(var j = 0; j < wordcount; ++j){
                subdata[wordsdata[j].ngram] = wordsdata[j].timeseries[i];
              }
              subdata["time"] = (18000000 + 10000 * i).toString();
              dataforrender.push(subdata);
            }
            if(plot === null){
              plot = new Draw();
            }            
            plot.setData(dataforrender);
            plot.render();
          });
          $("#wordlist").empty();
          $newol = $('<ol />');
            $newol.attr({
              "class": "breadcrumb"
            });
          for(var i = 0; i < words.length; ++i){            
            $newli = $('<li />');
            $newspan = $('<span />');
            $newspan.attr({
              "class": wordtagcss[parseInt(Math.random() * 5)]
            });
            $newspan.text(words[i]);
            $newli.append($newspan);
            $newol.append($newli);
            $("#wordlist").append($newol);                        
          }
        };
        $("#inputbutton").click(action);
        $("#wordinput").keydown(function(event){
          if(event.which == 13){
            event.preventDefault();
            action();
          }
        });
      });
    </script>
  </head>

  <body>

    <div class="container">
      <div class="header">
        <h3 class="text-muted">Knowledge Discover</h3>
      </div>

      <div class="jumbotron">
        <p class="lead">Input whatever words you want to Know!</p>
        <div class="row">
          <div class="col-lg-6">
            <div class="input-group">
              <input id="wordinput" type="text" class="form-control">
              <span class="input-group-btn">
                <button id="inputbutton" class="btn btn-default" type="button">Go!</button>
              </span>
            </div><!-- /input-group -->
          </div><!-- /.col-lg-6 -->
        </div><!-- /.row -->
        <p>
          <div id="wordlist">
          </div>
        </p>    
      </div>
      <div id="canvas"></div>
      <div class="footer">
        <p>&copy; Company 2014</p>
      </div>

    </div>
  </body>
</html>